{"paragraphs":[{"title":"Spark & CHO Data - Spark Workshop, Code4Lib 2018","text":"%md\nSpark Workshop, code4lib 2018\nMaterials at [github.com/spark4lib/code4lib2018](https://github.com/spark4lib/code4lib2018)\n\nThe following steps should also be available, with other notes, here: [https://github.com/spark4lib/code4lib2018/tree/master/worksheets/](https://github.com/spark4lib/code4lib2018/tree/master/worksheets) .","dateUpdated":"2018-02-11T22:32:16+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Spark Workshop, code4lib 2018<br/>Materials at <a href=\"https://github.com/spark4lib/code4lib2018\">github.com/spark4lib/code4lib2018</a></p>\n<p>The following steps should also be available, with other notes, here: <a href=\"https://github.com/spark4lib/code4lib2018/tree/master/worksheets\">https://github.com/spark4lib/code4lib2018/tree/master/worksheets/</a> .</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598939_-2116035011","id":"20180131-144721_1911570621","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17447"},{"title":"Introduction","text":"%md\nIn this session, we want you to apply what we learned in Spark Shell Introduction (Spark SQL, PySpark, & Zeppelin) for analyzing some provided Cultural Heritage Organization (CHO) data. \n\nYou will be working in small groups on this.","dateUpdated":"2018-02-11T22:33:32+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In this session, you will learn Zeppelin, Spark, &amp; Spark SQL basics via primarily the DataFrames API. We are starting with a really simple dataset to focus on the tools. In the next session, we will use an expanded cultural heritage metadata set.</p>\n<h4>Datasets? DataFrames?</h4>\n<p>A <strong>Dataset</strong> is a distributed collection of data. Dataset provides the benefits of strong typing, ability to use powerful lambda functions with the benefits of (Spark SQL’s) optimized execution engine. A Dataset can be constructed from JVM objects and then manipulated using functional transformations (map, flatMap, filter, etc.). The Dataset API is available in Scala and Java.</p>\n<p>A <strong>DataFrame</strong> is a Dataset organized into named columns. It is conceptually equivalent to a table in a relational database or a data frame in R/Python, but with richer optimizations under the hood. DataFrames can be constructed from a wide array of sources such as: structured data files, tables in Hive, external databases, or existing RDDs. The DataFrame API is available in Scala, Java, Python, and R. In Scala and Java, a DataFrame is represented by a Dataset of Rows. In the Scala API, DataFrame is simply a type alias of Dataset[Row]. (Note that in Scala type parameters (generics) are enclosed in square brackets.)</p>\n<p>[<a href=\"http://spark.apache.org/docs/2.0.0/sql-programming-guide.html#datasets-and-dataframes\">source</a>]</p>\n<h4>How to run a paragraph</h4>\n<p>To run a paragraph in a Zeppelin notebook, you can either click the <code>play</code> button (blue triangle) on the right-hand side or click on the paragraph simply press <code>Shift + Enter</code>.</p>\n<h4>What are Zeppelin Interpreters?</h4>\n<p>In the following paragraphs we are going to execute Spark code, run shell commands to download and move files, run sql queries etc. Each paragraph will start with <code>%</code> followed by an interpreter name, e.g. <code>%spark2</code> for a Spark 2.x interpreter. Different interpreter names indicate what will be executed: code, markdown, html etc. This allows you to perform data ingestion, munging, wrangling, visualization, analysis, processing and more, all in one place!</p>\n<p>Throughout this notebook we will use the following interpreters:</p>\n<ul>\n  <li>`` - the default interpreter is set to be PySpark for our Workshop Docker Container.</li>\n  <li><code>%spark</code> - Spark interpreter to run Spark code written in Scala</li>\n  <li><code>%spark.sql</code> - Spark SQL interprter (to execute SQL queries against temporary tables in Spark)</li>\n  <li><code>%sh</code> - Shell interpreter to run shell commands</li>\n  <li><code>%angular</code> - Angular interpreter to run Angular and HTML code</li>\n  <li><code>%md</code> - Markdown for displaying formatted text, links, and images</li>\n</ul>\n<p>To learn more about Zeppelin interpreters check out this <a href=\"https://zeppelin.apache.org/docs/0.5.6-incubating/manual/interpreters.html\">link</a>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598939_-2116035011","id":"20180211-041642_2058564180","dateCreated":"2018-02-11T21:13:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17448","user":"anonymous","dateFinished":"2018-02-11T22:27:11+0000","dateStarted":"2018-02-11T22:27:11+0000"},{"title":"Environment Set-up Test","text":"%spark\n\nprintln(\"Spark Version: \" + sc.version)\n\nval penndata = sc.textFile(\"penn.csv\")\nval cmoadata = sc.textFile(\"cmoa.csv\")\nprintln(\"penn count: \" + penndata.count)\nprintln(\"cmoadata count: \" + cmoadata.count)","dateUpdated":"2018-02-11T22:28:02+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark Version: 2.1.0\npenndata: org.apache.spark.rdd.RDD[String] = penn.csv MapPartitionsRDD[2538] at textFile at <console>:28\ncmoadata: org.apache.spark.rdd.RDD[String] = cmoa.csv MapPartitionsRDD[2540] at textFile at <console>:27\npenn count: 379317\ncmoadata count: 34596\n"}]},"apps":[],"jobName":"paragraph_1518383598940_-2117958755","id":"20180131-144538_432654498","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17449"},{"title":"Preview CHO Data Options","text":"%sh\n\ncat code4lib2018/sample-data/cmoa/README\nhead code4lib2018/sample-data/cmoa/cmoa.csv\ncat code4lib2018/sample-data/penn\\ museum/README\nunzip code4lib2018/sample-data/penn\\ museum/all-20180121.zip -d code4lib2018/sample-data/penn\\ museum/\nhead code4lib2018/sample-data/penn\\ museum/all-20180121.csv","dateUpdated":"2018-02-11T22:37:39+0000","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Carnegie Museum of Art\n\nGithub Repo\n---------\nhttps://github.com/cmoa/collection\ntitle,creation_date,creation_date_earliest,creation_date_latest,medium,accession_number,id,credit_line,date_acquired,department,physical_location,item_width,item_height,item_depth,item_diameter,web_url,provenance_text,classification,image_url,artist_id,party_type,full_name,cited_name,role,nationality,birth_date,death_date,birth_place,death_place\nKeith Haring,1984,1984-01-01,1984-01-01,gelatin silver print,2002.17,cmoa:things/692a68c5-af1e-4124-80f1-cbf38be51abe,Milton Fine Fund,2002-06-06,Contemporary Art,Not on View,23.25,29.25,1.25,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=1,\"The Robert Mapplethorpe Foundation, 2002\",photographs,http://collection.cmoa.org/CollectionImage.aspx?irn=114327&size=Medium,cmoa:parties/2cb30976-c292-4060-9dea-ba0e9504dda7,Person,Robert Mapplethorpe,\"Mapplethorpe, Robert\",\"\",American,1947-01-01,1989-01-01,\"New York City (New York state, United States)\",\"New York City (New York state, United States)\"\nUntitled,1964-1965,1964-01-01,1965-01-01,oil on canvas,2002.19,cmoa:things/871505af-a072-4a84-ab09-3abf932951b8,Joseph Soffer Family Trust Fund,2002-06-06,Contemporary Art,\"Gallery 13, Scaife Galleries\",60.5,48.25,2.25,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=2,\"(Daniel Weinberg Gallery), Santa Monica, CA; Museum purchase, 2002.\n\nTBF 10/30/14\",paintings,http://collection.cmoa.org/CollectionImage.aspx?irn=98202&size=Medium,cmoa:parties/b5cb7ad2-50ca-4c5b-8a80-74202ddfb9c2,Person,Jo Baer,\"Baer, Jo\",\"\",American,1929-01-01,\"\",\"Seattle (King County, Washington, United States)\",\"\"\nTrans East West (Tew) No. 5: The Attack of the Embassy (Reconstruction),1999,1999-01-01,1999-01-01,mixed media on paper,2002.18.1,cmoa:things/fe93f7e2-e4ca-455e-bdfa-ea9be22cce8a,Second Century Acquisition Fund,2002-06-06,Contemporary Art,Not on View,7.5,5.125,0.0,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=3,\"\",drawings and watercolors,,cmoa:parties/4c7afe88-ebfe-4e3b-9010-9ddcb1e11674,Person,Franz Ackermann,\"Ackermann, Franz\",\"\",German,1963-01-01,\"\",\"Neumarkt-Sankt Veit (Oberbayern, Bavaria, Germany)\",\"\"\nTrans East West (Tew) No. 6: Rebuilding Beyrut,1999,1999-01-01,1999-01-01,mixed media on paper,2002.18.2,cmoa:things/9ee75ef7-d8a6-47bc-a0fe-dda1ec7d2984,Second Century Acquisition Fund,2002-06-06,Contemporary Art,Not on View,7.438,5.125,0.0,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=4,\"\",drawings and watercolors,,cmoa:parties/4c7afe88-ebfe-4e3b-9010-9ddcb1e11674,Person,Franz Ackermann,\"Ackermann, Franz\",\"\",German,1963-01-01,\"\",\"Neumarkt-Sankt Veit (Oberbayern, Bavaria, Germany)\",\"\"\nTrans East West (Tew) No. 7: Bombing the Power Plant,1999,1999-01-01,1999-01-01,mixed media on paper,2002.18.3,cmoa:things/d4e7057c-6f1f-4bce-be3e-579fe5ab2af6,Second Century Acquisition Fund,2002-06-06,Contemporary Art,Not on View,7.5,5.125,0.0,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=5,\"\",drawings and watercolors,,cmoa:parties/4c7afe88-ebfe-4e3b-9010-9ddcb1e11674,Person,Franz Ackermann,\"Ackermann, Franz\",\"\",German,1963-01-01,\"\",\"Neumarkt-Sankt Veit (Oberbayern, Bavaria, Germany)\",\"\"\nTrans East West (Tew) No. 8: Suddenly It was Completely Dark (Maybe Because I Closed My Eyes),1999,1999-01-01,1999-01-01,mixed media on paper,2002.18.4,cmoa:things/96622b88-ed5f-44cf-8493-852c4b53fbad,Second Century Acquisition Fund,2002-06-06,Contemporary Art,Not on View,7.5,5.125,0.0,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=6,\"\",drawings and watercolors,,cmoa:parties/4c7afe88-ebfe-4e3b-9010-9ddcb1e11674,Person,Franz Ackermann,\"Ackermann, Franz\",\"\",German,1963-01-01,\"\",\"Neumarkt-Sankt Veit (Oberbayern, Bavaria, Germany)\",\"\"\n\"Trans East West (Tew) No. 9: The \"\"Meridien\"\" Will Have a Nice View\",1999,1999-01-01,1999-01-01,mixed media on paper,2002.18.5,cmoa:things/41ee79b1-22cd-43c1-b112-31c63ba5cc68,Second Century Acquisition Fund,2002-06-06,Contemporary Art,Not on View,12.875,10.563,1.0,0.0,http://collection.cmoa.org/CollectionDetail.aspx?item=7,\"\",drawings and watercolors,,cmoa:parties/4c7afe88-ebfe-4e3b-9010-9ddcb1e11674,Person,Franz Ackermann,\"Ackermann, Franz\",\"\",German,1963-01-01,\"\",\"Neumarkt-Sankt Veit (Oberbayern, Bavaria, Germany)\",\"\"\nPenn Museum\n\nREADME\n------\nhttps://www.penn.museum/collections/objects/data.php\nArchive:  code4lib2018/sample-data/penn museum/all-20180121.zip\nreplace code4lib2018/sample-data/penn museum/all-20180121.csv? [y]es, [n]o, [A]ll, [N]one, [r]ename:  NULL\n(EOF or read error, treating as \"[N]one\" ...)\n﻿emuIRN,curatorial_section,object_number,object_name,native_name,culture,provenience,material,period,date_made,date_made_early,date_made_late,accession_credit_line,creator,description,manufacture_locationlocus,culture_area,technique,iconography,measurement_height,measurement_length,measurement_width,measurement_outside_diameter,measurement_tickness,measurement_unit,other_numbers,url\r\n241947,American,29-47-124,Seal Drag Handle,,Eskimo,Northern Alaska|British America,Seal Skin,,,,,\"Purchased from Joseph Bernard; subscription of John Wanamaker, 1915\",,Sealskin. Knotted.,,Arctic (Culture Area),,,,45.7,,,,cm,,http://www.penn.museum/collections/object/241947\n187327,American,29-151-169,Lance,,Eskimo,Northern Alaska|Alaska,Bone|Iron,,,,,\"Gift of Judson Daland, 1923\",,Bone foreshaft with small barb at proximal end. Triangular iron blade riveted in.,,Arctic (Culture Area),,,,21.5,0.9,,,cm,,http://www.penn.museum/collections/object/187327\n353827,American,40-16-1749,Vessel|Sherds,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,,,Central America,,,,,,,,cm,B19 - 12,http://www.penn.museum/collections/object/353827\n349877,American,40-16-949,Vessel|Pedestal|Sherds,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,,,Central America,,,,,,,,cm,B19 - 50,http://www.penn.museum/collections/object/349877\n349878,American,40-16-921,Carafe|Sherds,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,,,Central America,,,,,,,,cm,B19 - 15,http://www.penn.museum/collections/object/349878\n349879,American,40-16-1751,Vessel|Sherds,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,Red.,,Central America,,,,,,,,cm,B19 - 12,http://www.penn.museum/collections/object/349879\n349880,American,40-16-1752,Handles|Sherds,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,Black.,,Central America,,,,,,,,cm,B19 - 12,http://www.penn.museum/collections/object/349880\n353824,American,40-16-1753,Carafe|Neck Sherd,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,Neck of a carafe.,,Central America,,,,,,,,cm,B19 - 12,http://www.penn.museum/collections/object/353824\n353825,American,40-16-1747,Carafe|Sherds,,Cocle,Panama|Sitio Conte,Ceramic,,AD 450 - 900,450,900,\"Panama, Cocle Expedition;  J. Alden Mason, 1940\",,,,Central America,,,,,,,,cm,B19 - 2,http://www.penn.museum/collections/object/353825\n"}]},"apps":[],"jobName":"paragraph_1518383598940_-2117958755","id":"20180210-010216_1168213332","dateCreated":"2018-02-11T21:13:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17450","user":"anonymous","dateFinished":"2018-02-11T22:37:40+0000","dateStarted":"2018-02-11T22:37:40+0000"},{"title":"","text":"%md\n# Part 1: Creating a Dataframe Instance from CHO CSV","dateUpdated":"2018-02-11T22:38:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 1: Creating a Dataframe Instance from CHO CSV</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598940_-2117958755","id":"20180211-043612_1888524633","dateCreated":"2018-02-11T21:13:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17452","user":"anonymous","dateFinished":"2018-02-11T22:38:07+0000","dateStarted":"2018-02-11T22:38:07+0000"},{"title":"Read a CSV File into a Dataframe Instance with Headers","text":"pennDf = spark.read.csv(\"code4lib2018/sample-data/penn\\ museum/all-20180121.csv\", header=True, inferSchema=True)\npennDf.printSchema()","dateUpdated":"2018-02-11T23:36:35+0000","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- emuIRN: string (nullable = true)\n |-- curatorial_section: string (nullable = true)\n |-- object_number: string (nullable = true)\n |-- object_name: string (nullable = true)\n |-- native_name: string (nullable = true)\n |-- culture: string (nullable = true)\n |-- provenience: string (nullable = true)\n |-- material: string (nullable = true)\n |-- period: string (nullable = true)\n |-- date_made: string (nullable = true)\n |-- date_made_early: string (nullable = true)\n |-- date_made_late: string (nullable = true)\n |-- accession_credit_line: string (nullable = true)\n |-- creator: string (nullable = true)\n |-- description: string (nullable = true)\n |-- manufacture_locationlocus: string (nullable = true)\n |-- culture_area: string (nullable = true)\n |-- technique: string (nullable = true)\n |-- iconography: string (nullable = true)\n |-- measurement_height: string (nullable = true)\n |-- measurement_length: string (nullable = true)\n |-- measurement_width: string (nullable = true)\n |-- measurement_outside_diameter: string (nullable = true)\n |-- measurement_tickness: string (nullable = true)\n |-- measurement_unit: string (nullable = true)\n |-- other_numbers: string (nullable = true)\n |-- url: string (nullable = true)\n\n+------+------------------+-------------+--------------------+-----------+-------+--------------------+---------+------+------------+---------------+--------------+---------------------+-------+--------------------+-------------------------+--------------------+---------+-----------+------------------+------------------+-----------------+----------------------------+--------------------+----------------+-------------+--------------------+\n|emuIRN|curatorial_section|object_number|         object_name|native_name|culture|         provenience| material|period|   date_made|date_made_early|date_made_late|accession_credit_line|creator|         description|manufacture_locationlocus|        culture_area|technique|iconography|measurement_height|measurement_length|measurement_width|measurement_outside_diameter|measurement_tickness|measurement_unit|other_numbers|                 url|\n+------+------------------+-------------+--------------------+-----------+-------+--------------------+---------+------+------------+---------------+--------------+---------------------+-------+--------------------+-------------------------+--------------------+---------+-----------+------------------+------------------+-----------------+----------------------------+--------------------+----------------+-------------+--------------------+\n|241947|          American|    29-47-124|    Seal Drag Handle|       null| Eskimo|Northern Alaska|B...|Seal Skin|  null|        null|           null|          null| Purchased from Jo...|   null|  Sealskin. Knotted.|                     null|Arctic (Culture A...|     null|       null|              null|              45.7|             null|                        null|                null|              cm|         null|http://www.penn.m...|\n|187327|          American|   29-151-169|               Lance|       null| Eskimo|Northern Alaska|A...|Bone|Iron|  null|        null|           null|          null| Gift of Judson Da...|   null|Bone foreshaft wi...|                     null|Arctic (Culture A...|     null|       null|              null|              21.5|              0.9|                        null|                null|              cm|         null|http://www.penn.m...|\n|353827|          American|   40-16-1749|       Vessel|Sherds|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|                null|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 12|http://www.penn.m...|\n|349877|          American|    40-16-949|Vessel|Pedestal|S...|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|                null|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 50|http://www.penn.m...|\n|349878|          American|    40-16-921|       Carafe|Sherds|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|                null|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 15|http://www.penn.m...|\n|349879|          American|   40-16-1751|       Vessel|Sherds|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|                Red.|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 12|http://www.penn.m...|\n|349880|          American|   40-16-1752|      Handles|Sherds|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|              Black.|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 12|http://www.penn.m...|\n|353824|          American|   40-16-1753|   Carafe|Neck Sherd|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|   Neck of a carafe.|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 12|http://www.penn.m...|\n|353825|          American|   40-16-1747|       Carafe|Sherds|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|                null|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|      B19 - 2|http://www.penn.m...|\n|353826|          American|   40-16-1761|        Plate|Sherds|       null|  Cocle|  Panama|Sitio Conte|  Ceramic|  null|AD 450 - 900|            450|           900| Panama, Cocle Exp...|   null|                null|                     null|     Central America|     null|       null|              null|              null|             null|                        null|                null|              cm|     B19 - 27|http://www.penn.m...|\n+------+------------------+-------------+--------------------+-----------+-------+--------------------+---------+------+------------+---------------+--------------+---------------------+-------+--------------------+-------------------------+--------------------+---------+-----------+------------------+------------------+-----------------+----------------------------+--------------------+----------------+-------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1518383598941_-2118343504","id":"20180210-002750_1470779955","dateCreated":"2018-02-11T21:13:18+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:17454","user":"anonymous","dateFinished":"2018-02-11T23:33:21+0000","dateStarted":"2018-02-11T23:33:21+0000"},{"user":"anonymous","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518392120695_-637591431","id":"20180211-233520_399031330","dateCreated":"2018-02-11T23:35:20+0000","status":"RUNNING","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22333","text":"pennDf.show(10, truncate=True)","dateUpdated":"2018-02-11T23:35:32+0000","dateStarted":"2018-02-11T23:35:32+0000","errorMessage":"","title":"Read a CSV File into a Dataframe Instance with Headers"},{"user":"anonymous","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518392402575_-684132368","id":"20180211-234002_1351508361","dateCreated":"2018-02-11T23:40:02+0000","status":"ABORT","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22411","dateUpdated":"2018-02-11T23:41:42+0000","text":"pennDf.select('emuIRN').distinct()"},{"user":"anonymous","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518392430641_171579834","id":"20180211-234030_834783507","dateCreated":"2018-02-11T23:40:30+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22477","text":"pennDf.select('object_number').distinct()","dateUpdated":"2018-02-11T23:41:50+0000"},{"user":"anonymous","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518392438860_1291983956","id":"20180211-234038_1787924327","dateCreated":"2018-02-11T23:40:38+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22540","text":"pennDf.select('culture').distinct()","dateUpdated":"2018-02-11T23:42:08+0000"},{"title":"Create Our Own Schema & Read the CSV into a Dataframe Instance with our Schema","text":"from pyspark.sql.types import *\n\npennSchema = StructType([\n  StructField(\"emuIRN\", IntegerType(), False),\n  StructField(\"curatorial_section\", StringType(), True),\n  StructField(\"object_number\", StringType(), True),\n  StructField(\"object_name\", StringType(), True),\n  StructField(\"native_name\", StringType(), True),\n  StructField(\"culture\", StringType(), True)]),\n  StructField(\"provenience\", StringType(), True),\n  StructField(\"material\", StringType(), True),\n  StructField(\"period\", StringType(), True),\n  StructField(\"date_made\", StringType(), True),\n  StructField(\"date_made_early\", StringType(), True),\n  StructField(\"date_made_late\", StringType(), True),\n  StructField(\"accession_credit_line\", StringType(), True),\n  StructField(\"creator\", StringType(), True),\n  StructField(\"description\", StringType(), True),\n  StructField(\"manufacture_locationlocus\", StringType(), True),\n  StructField(\"culture_area\", StringType(), True),\n  StructField(\"technique\", StringType(), True),\n  StructField(\"iconography\", StringType(), True),\n  StructField(\"measurement_height\", StringType(), True),\n  StructField(\"measurement_length\", StringType(), True),\n  StructField(\"measurement_width\", StringType(), True),\n  StructField(\"measurement_outside_diameter\", StringType(), True),\n  StructField(\"measurement_tickness\", StringType(), True),\n  StructField(\"measurement_unit\", StringType(), True),\n  StructField(\"other_numbers\", StringType(), True),\n  StructField(\"url\", StringType(), True)])\n\n\npennDf = spark.read.csv(\"code4lib2018/sample-data/penn\\ museum/all-20180121.csv\", header=True, schema=pennSchema)\npennDf = sample(False, 0.10, 42).count()\npennDf.show(5, truncate=True)","dateUpdated":"2018-02-11T23:44:42+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598942_-2117189258","id":"20180205-224139_1405421836","dateCreated":"2018-02-11T21:13:18+0000","status":"PENDING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17460","user":"anonymous","dateStarted":"2018-02-11T23:44:42+0000"},{"title":"","text":"%md\n### Stopping Point: Have you been able to walk through, quickly assess, select, and load a CHO CSV into a Dataframe?","dateUpdated":"2018-02-11T23:45:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: Have you been able to walk through, quickly assess, select, and load a CHO CSV into a Dataframe?</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598942_-2117189258","id":"20180211-204040_1741647870","dateCreated":"2018-02-11T21:13:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17461","user":"anonymous","dateFinished":"2018-02-11T23:45:11+0000","dateStarted":"2018-02-11T23:45:11+0000"},{"title":"","text":"%md\n# Part 2: Simple Analysis of our Dataset via Dataframe API","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 2: Simple Analysis of our Dataset via Dataframe API</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598942_-2117189258","id":"20180211-044238_542100528","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17462"},{"title":"Return First n Rows in your Dataframe ( .head(n) )","text":"sampleDf.head(2)","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(Name=u'CMOA', Institution Type=u'Museum', Format=u'JSON, CSV', URL=u'https://github.com/cmoa/collection', Description=None, Informal Score=Decimal('10')), Row(Name=u'Penn Museum', Institution Type=u'Museum', Format=u'JSON, CSV, XML', URL=u'https://www.penn.museum/collections/data.php', Description=u'JSON is poorly structured', Informal Score=Decimal('7'))]\n"}]},"apps":[],"jobName":"paragraph_1518383598942_-2117189258","id":"20180210-203445_1454325544","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17463"},{"title":"Show Columns ( .columns() ) & Number of Columns ( .len() ) in your Dataframe","text":"print(sampleDf.columns)\nprint(len(sampleDf.columns))","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Name', 'Institution Type', 'Format', 'URL', 'Description', 'Informal Score']\n6\n"}]},"apps":[],"jobName":"paragraph_1518383598943_-2117574006","id":"20180210-203724_1788119369","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17464"},{"title":"Show Specific Columns ( .select() )","text":"sampleDf.select(\"Name\").show()\nsampleDf.select(\"Name\", \"Informal Score\").show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                Name|\n+--------------------+\n|                CMOA|\n|         Penn Museum|\n|          Met Museum|\n|DigitalNZ Te Puna...|\n|Canadian Subject ...|\n|                DPLA|\n+--------------------+\n\n+--------------------+--------------+\n|                Name|Informal Score|\n+--------------------+--------------+\n|                CMOA|            10|\n|         Penn Museum|             7|\n|          Met Museum|             3|\n|DigitalNZ Te Puna...|             3|\n|Canadian Subject ...|             4|\n|                DPLA|           100|\n+--------------------+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598943_-2117574006","id":"20180211-044743_1705262796","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17465"},{"title":"Selecting Columns ( .select() ) versus Apply Filters ( .filter() )","text":"scoresBooleanDf = sampleDf.select('Name', 'URL', sampleDf['Informal Score'] > 5)\nscoresBooleanDf.show()\n\nhighScoresDf = sampleDf.filter(sampleDf['Informal Score'] > 5)\nhighScoresDf.select('Name', 'URL', 'Informal Score').show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+\n|                Name|                 URL|(Informal Score > 5)|\n+--------------------+--------------------+--------------------+\n|                CMOA|https://github.co...|                true|\n|         Penn Museum|https://www.penn....|                true|\n|          Met Museum|                null|               false|\n|DigitalNZ Te Puna...|https://natlib.go...|               false|\n|Canadian Subject ...|http://www.collec...|               false|\n|                DPLA|               dp.la|                true|\n+--------------------+--------------------+--------------------+\n\n+-----------+--------------------+--------------+\n|       Name|                 URL|Informal Score|\n+-----------+--------------------+--------------+\n|       CMOA|https://github.co...|            10|\n|Penn Museum|https://www.penn....|             7|\n|       DPLA|               dp.la|           100|\n+-----------+--------------------+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598943_-2117574006","id":"20180210-011244_1927422767","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17466"},{"title":"How Many Rows? ( .count() )","text":"numSampleDf = sampleDf.count()\nnumHighScoresDf = highScoresDf.count()\n\nprint(\"Percentage of Datasets with a Score at or above 5: \" + str(float(numHighScoresDf)/float(numSampleDf)*100) + \"%\")","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Percentage of Datasets with a Score at or above 5: 50.0%\n"}]},"apps":[],"jobName":"paragraph_1518383598943_-2117574006","id":"20180205-225126_643532571","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17467"},{"title":"Show First n Rows of Dataframe in Show View ( .show(n) )","text":"sampleDf.show(2,truncate=True)","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------------+--------------+--------------------+--------------------+--------------+\n|       Name|Institution Type|        Format|                 URL|         Description|Informal Score|\n+-----------+----------------+--------------+--------------------+--------------------+--------------+\n|       CMOA|          Museum|     JSON, CSV|https://github.co...|                null|            10|\n|Penn Museum|          Museum|JSON, CSV, XML|https://www.penn....|JSON is poorly st...|             7|\n+-----------+----------------+--------------+--------------------+--------------------+--------------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1518383598943_-2117574006","id":"20180210-203520_832539356","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17468"},{"title":"Show Stats Summary of your Dataframe ( .describe() )","text":"sampleDf.describe().show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------+----------------+------+--------------------+--------------------+-----------------+\n|summary|       Name|Institution Type|Format|                 URL|         Description|   Informal Score|\n+-------+-----------+----------------+------+--------------------+--------------------+-----------------+\n|  count|          6|               6|     6|                   5|                   4|                6|\n|   mean|       null|            null|  null|                null|                null|          21.1667|\n| stddev|       null|            null|  null|                null|                null|38.71649088782022|\n|    min|       CMOA|     Aggregator |   CSV|               dp.la|JSON is poorly st...|                3|\n|    max|Penn Museum|          Museum|   XML|https://www.penn....|            ¯_(ツ)_/¯|              100|\n+-------+-----------+----------------+------+--------------------+--------------------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598944_-2131809716","id":"20180210-203742_684138715","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17469"},{"title":"Show Stats Summary of a Specific Column ( .describe(colName) , DecimalType)","text":"sampleDf.describe('Informal Score').show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|summary|   Informal Score|\n+-------+-----------------+\n|  count|                6|\n|   mean|          21.1667|\n| stddev|38.71649088782022|\n|    min|                3|\n|    max|              100|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598944_-2131809716","id":"20180210-211801_243937278","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17470"},{"title":"Show Stats Summary of a Specific Column ( .describe(colName) , StringType)","text":"sampleDf.describe('URL').show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+\n|summary|                 URL|\n+-------+--------------------+\n|  count|                   5|\n|   mean|                null|\n| stddev|                null|\n|    min|               dp.la|\n|    max|https://www.penn....|\n+-------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598944_-2131809716","id":"20180211-073524_2028466772","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17471"},{"title":"","text":"%md\n### Stopping Point: Have you been able to walk through reviewing some Rows & Columns?","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: Have you been able to walk through reviewing some Rows &amp; Columns?</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598944_-2131809716","id":"20180211-204350_627919107","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17472"},{"title":"Your Working Space: Analysis of Data I","text":"\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598944_-2131809716","id":"20180211-204610_53073346","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17473"},{"title":"Order Dataframe Views by a Column ( .orderBy(colName) | .orderBy(colName).desc() )","text":"sampleDf.orderBy(\"Informal Score\").show()\nsampleDf.orderBy(sampleDf[\"Informal Score\"].desc()).show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------------+--------------+--------------------+--------------------+--------------+\n|                Name|Institution Type|        Format|                 URL|         Description|Informal Score|\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+\n|DigitalNZ Te Puna...|         Library|           XML|https://natlib.go...|            MARC XML|             3|\n|          Met Museum|          Museum|           CSV|                null|            ¯_(ツ)_/¯|             3|\n|Canadian Subject ...|         Library|       RDF/XML|http://www.collec...|            Ugh, rdf|             4|\n|         Penn Museum|          Museum|JSON, CSV, XML|https://www.penn....|JSON is poorly st...|             7|\n|                CMOA|          Museum|     JSON, CSV|https://github.co...|                null|            10|\n|                DPLA|     Aggregator |  CSV,JSON,XML|               dp.la|                null|           100|\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+\n\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+\n|                Name|Institution Type|        Format|                 URL|         Description|Informal Score|\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+\n|                DPLA|     Aggregator |  CSV,JSON,XML|               dp.la|                null|           100|\n|                CMOA|          Museum|     JSON, CSV|https://github.co...|                null|            10|\n|         Penn Museum|          Museum|JSON, CSV, XML|https://www.penn....|JSON is poorly st...|             7|\n|Canadian Subject ...|         Library|       RDF/XML|http://www.collec...|            Ugh, rdf|             4|\n|          Met Museum|          Museum|           CSV|                null|            ¯_(ツ)_/¯|             3|\n|DigitalNZ Te Puna...|         Library|           XML|https://natlib.go...|            MARC XML|             3|\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598945_-2132194465","id":"20180210-212920_1413184855","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17474"},{"title":"Group Values by a Column ( .groupBy(colName) ) ","text":"URLGroupDf = sampleDf.groupBy(\"Format\").count()\n\nURLGroupDf.show()\nURLGroupDf.printSchema()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-----+\n|        Format|count|\n+--------------+-----+\n|           CSV|    1|\n|           XML|    1|\n|     JSON, CSV|    1|\n|JSON, CSV, XML|    1|\n|       RDF/XML|    1|\n|  CSV,JSON,XML|    1|\n+--------------+-----+\n\nroot\n |-- Format: string (nullable = true)\n |-- count: long (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1518383598945_-2132194465","id":"20180210-011435_1074589917","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17475"},{"title":"Group Values by a Column then Compute an Aggregation ( .agg(expr) )","text":"# Note, this is setting us up for Splitting Values later on\n\nformatGroupDf = sampleDf.groupBy(\"Format\").agg({\"Informal Score\": 'mean'})\nformatGroupDf.show()\nformatGroupDf.printSchema()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-------------------+\n|        Format|avg(Informal Score)|\n+--------------+-------------------+\n|           CSV|             3.0000|\n|           XML|             3.0000|\n|     JSON, CSV|            10.0000|\n|JSON, CSV, XML|             7.0000|\n|       RDF/XML|             4.0000|\n|  CSV,JSON,XML|           100.0000|\n+--------------+-------------------+\n\nroot\n |-- Format: string (nullable = true)\n |-- avg(Informal Score): decimal(14,4) (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1518383598945_-2132194465","id":"20180211-053908_436020978","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17476"},{"title":"Show & Count Distinct Values in a Selected Column ( .distinct() )","text":"# Note, this is also setting us up for Splitting Values later on\n\ndistinctFormatDf = sampleDf.select(\"Format\").distinct()\ndistinctFormatDf.show()\ndistinctFormatDf.count()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+\n|        Format|\n+--------------+\n|           CSV|\n|           XML|\n|     JSON, CSV|\n|JSON, CSV, XML|\n|       RDF/XML|\n|  CSV,JSON,XML|\n+--------------+\n\n6\n"}]},"apps":[],"jobName":"paragraph_1518383598945_-2132194465","id":"20180210-211959_911280658","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17477"},{"title":"Use Aggregations ( .agg() ) & Sql Functions for Number of Distinct Values in Format ( countDistinct(colName) )","text":"from pyspark.sql.functions import countDistinct\n\ncountDistinctDF = sampleDf.select(\"Name\", \"Institution Type\", \"Format\").groupBy(\"Institution Type\").agg(countDistinct(\"Format\"))\ncountDistinctDF.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+----------------------+\n|Institution Type|count(DISTINCT Format)|\n+----------------+----------------------+\n|         Library|                     2|\n|     Aggregator |                     1|\n|          Museum|                     3|\n+----------------+----------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598945_-2132194465","id":"20180211-035942_1079861047","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17478"},{"title":"","text":"%md\n### Stopping Point: Have you been able to group, order, get distinct values by column(s)?","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: Have you been able to group, order, get distinct values by column(s)?</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598946_-2131040218","id":"20180211-204432_1327378340","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17479"},{"title":"Your Working Space: Analysis of Data II","text":"\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598946_-2131040218","id":"20180211-204542_862151313","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17480"},{"title":"","text":"%md\n# Part 3: Creating New Dataframes to Expand or Rework our Original Dataset","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 3: Creating New Dataframes to Expand or Rework our Original Dataset</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598946_-2131040218","id":"20180211-052933_847596982","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17481"},{"title":"Create a Dataframe of DeDuplicated Values ( .dropDuplicates() )","text":"scoresDf = sampleDf.select('Informal Score').dropDuplicates()\nscoresDf.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+\n|Informal Score|\n+--------------+\n|             7|\n|            10|\n|           100|\n|             3|\n|             4|\n+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598946_-2131040218","id":"20180210-212128_106635954","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17482"},{"title":"Create a Dataframe with Null Values Dropped ( .dropna() ) or Null Values Filled ( .fillna(fillerVal) )","text":"noNullDf = sampleDf.select('Name', 'URL').dropna()\nnoNullDf.show()\n\nnonNullDf = sampleDf.select('Name', 'URL').fillna('No URL')\nnonNullDf.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+\n|                Name|                 URL|\n+--------------------+--------------------+\n|                CMOA|https://github.co...|\n|         Penn Museum|https://www.penn....|\n|DigitalNZ Te Puna...|https://natlib.go...|\n|Canadian Subject ...|http://www.collec...|\n|                DPLA|               dp.la|\n+--------------------+--------------------+\n\n+--------------------+--------------------+\n|                Name|                 URL|\n+--------------------+--------------------+\n|                CMOA|https://github.co...|\n|         Penn Museum|https://www.penn....|\n|          Met Museum|              No URL|\n|DigitalNZ Te Puna...|https://natlib.go...|\n|Canadian Subject ...|http://www.collec...|\n|                DPLA|               dp.la|\n+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598947_-2131424967","id":"20180210-212150_723012495","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17483"},{"title":"Create Dataframe where URL is Non Null ( col.isNull() && .filter() )","text":"filterNonNullDF = sampleDf.filter(sampleDf.URL.isNull()).sort(\"Name\")\nfilterNonNullDF.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------------+------+----+-----------+--------------+\n|      Name|Institution Type|Format| URL|Description|Informal Score|\n+----------+----------------+------+----+-----------+--------------+\n|Met Museum|          Museum|   CSV|null|   ¯_(ツ)_/¯|             3|\n+----------+----------------+------+----+-----------+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598947_-2131424967","id":"20180211-032722_1642010293","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17484"},{"title":"","text":"%md\n### Stopping Point: Create some Derivative Dataframes","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: Create some Derivative Dataframes</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598947_-2131424967","id":"20180211-205119_924209624","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17485"},{"title":"Your Working Space: Deriving Data I","text":"\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598947_-2131424967","id":"20180211-204757_140350285","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17486"},{"title":"Create a new DataFrame with 'Format Array' column ( .withColumn(colName, colValue) ) of Split Values ( split(col, delimiter) )","text":"from pyspark.sql.functions import split\n\nsampleDf = sampleDf.withColumn(\"Format Array\", split(sampleDf.Format, \",\"))\nsampleDf.show()\nsampleDf.printSchema()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------------+--------------+--------------------+--------------------+--------------+------------------+\n|                Name|Institution Type|        Format|                 URL|         Description|Informal Score|      Format Array|\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+------------------+\n|                CMOA|          Museum|     JSON, CSV|https://github.co...|                null|            10|      [JSON,  CSV]|\n|         Penn Museum|          Museum|JSON, CSV, XML|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]|\n|          Met Museum|          Museum|           CSV|                null|            ¯_(ツ)_/¯|             3|             [CSV]|\n|DigitalNZ Te Puna...|         Library|           XML|https://natlib.go...|            MARC XML|             3|             [XML]|\n|Canadian Subject ...|         Library|       RDF/XML|http://www.collec...|            Ugh, rdf|             4|         [RDF/XML]|\n|                DPLA|     Aggregator |  CSV,JSON,XML|               dp.la|                null|           100|  [CSV, JSON, XML]|\n+--------------------+----------------+--------------+--------------------+--------------------+--------------+------------------+\n\nroot\n |-- Name: string (nullable = true)\n |-- Institution Type: string (nullable = true)\n |-- Format: string (nullable = true)\n |-- URL: string (nullable = true)\n |-- Description: string (nullable = true)\n |-- Informal Score: decimal(10,0) (nullable = true)\n |-- Format Array: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n"}]},"apps":[],"jobName":"paragraph_1518383598947_-2131424967","id":"20180211-054754_1895175973","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17487"},{"title":"Use pyspark.sql.functions Explode ( explode(col) ) & Split ( .split(colName, delimiter) ) to Create a Row for each unique Format Value","text":"from pyspark.sql.functions import explode\n\nsampleDf = sampleDf.withColumn(\"Format\", explode(split(\"Format\", \",\")))\nsampleDf.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------------+-------+--------------------+--------------------+--------------+------------------+\n|                Name|Institution Type| Format|                 URL|         Description|Informal Score|      Format Array|\n+--------------------+----------------+-------+--------------------+--------------------+--------------+------------------+\n|                CMOA|          Museum|   JSON|https://github.co...|                null|            10|      [JSON,  CSV]|\n|                CMOA|          Museum|    CSV|https://github.co...|                null|            10|      [JSON,  CSV]|\n|         Penn Museum|          Museum|   JSON|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]|\n|         Penn Museum|          Museum|    CSV|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]|\n|         Penn Museum|          Museum|    XML|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]|\n|          Met Museum|          Museum|    CSV|                null|            ¯_(ツ)_/¯|             3|             [CSV]|\n|DigitalNZ Te Puna...|         Library|    XML|https://natlib.go...|            MARC XML|             3|             [XML]|\n|Canadian Subject ...|         Library|RDF/XML|http://www.collec...|            Ugh, rdf|             4|         [RDF/XML]|\n|                DPLA|     Aggregator |    CSV|               dp.la|                null|           100|  [CSV, JSON, XML]|\n|                DPLA|     Aggregator |   JSON|               dp.la|                null|           100|  [CSV, JSON, XML]|\n|                DPLA|     Aggregator |    XML|               dp.la|                null|           100|  [CSV, JSON, XML]|\n+--------------------+----------------+-------+--------------------+--------------------+--------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598948_-2133348711","id":"20180210-220422_1187559654","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17488"},{"title":"Create New Columns ( withColumn(colName, colValue) ) with Boolean if Format Type Present ( .like(Regex) )","text":"sampleDf.select(\"Format\").distinct().show()\nsampleDf = sampleDf.withColumn('CSV', sampleDf.Format.like(\"%CSV%\"))\nsampleDf = sampleDf.withColumn('XML', sampleDf.Format.like(\"%XML%\"))\nsampleDf = sampleDf.withColumn('RDF', sampleDf.Format.like(\"%RDF%\"))\nsampleDf = sampleDf.withColumn('JSON', sampleDf.Format.like(\"%JSON%\"))\nsampleDf.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":478,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n| Format|\n+-------+\n|    CSV|\n|    XML|\n|    CSV|\n|    XML|\n|RDF/XML|\n|   JSON|\n+-------+\n\n+--------------------+----------------+-------+--------------------+--------------------+--------------+------------------+-----+-----+-----+-----+\n|                Name|Institution Type| Format|                 URL|         Description|Informal Score|      Format Array|  CSV|  XML|  RDF| JSON|\n+--------------------+----------------+-------+--------------------+--------------------+--------------+------------------+-----+-----+-----+-----+\n|                CMOA|          Museum|   JSON|https://github.co...|                null|            10|      [JSON,  CSV]|false|false|false| true|\n|                CMOA|          Museum|    CSV|https://github.co...|                null|            10|      [JSON,  CSV]| true|false|false|false|\n|         Penn Museum|          Museum|   JSON|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]|false|false|false| true|\n|         Penn Museum|          Museum|    CSV|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]| true|false|false|false|\n|         Penn Museum|          Museum|    XML|https://www.penn....|JSON is poorly st...|             7|[JSON,  CSV,  XML]|false| true|false|false|\n|          Met Museum|          Museum|    CSV|                null|            ¯_(ツ)_/¯|             3|             [CSV]| true|false|false|false|\n|DigitalNZ Te Puna...|         Library|    XML|https://natlib.go...|            MARC XML|             3|             [XML]|false| true|false|false|\n|Canadian Subject ...|         Library|RDF/XML|http://www.collec...|            Ugh, rdf|             4|         [RDF/XML]|false| true| true|false|\n|                DPLA|     Aggregator |    CSV|               dp.la|                null|           100|  [CSV, JSON, XML]| true|false|false|false|\n|                DPLA|     Aggregator |   JSON|               dp.la|                null|           100|  [CSV, JSON, XML]|false|false|false| true|\n|                DPLA|     Aggregator |    XML|               dp.la|                null|           100|  [CSV, JSON, XML]|false| true|false|false|\n+--------------------+----------------+-------+--------------------+--------------------+--------------+------------------+-----+-----+-----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598948_-2133348711","id":"20180210-213550_325903017","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17489"},{"title":"Transform our Dataframe to RDD ( .rdd ) & Map a function ( .map(lambda) )","text":"sampleRdd = sampleDf.select(\"Format\").rdd.map(lambda x: x[0].split(\",\"))\nsampleRdd.take(5)","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[u'JSON'], [u' CSV'], [u'JSON'], [u' CSV'], [u' XML']]\n"}]},"apps":[],"jobName":"paragraph_1518383598948_-2133348711","id":"20180211-055309_116193468","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17490"},{"title":"Drop the Previous Format Array Column","text":"sampleDf = sampleDf.drop('Format Array')\nsampleDf.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------------+-------+--------------------+--------------------+--------------+-----+-----+-----+-----+\n|                Name|Institution Type| Format|                 URL|         Description|Informal Score|  CSV|  XML|  RDF| JSON|\n+--------------------+----------------+-------+--------------------+--------------------+--------------+-----+-----+-----+-----+\n|                CMOA|          Museum|   JSON|https://github.co...|                null|            10|false|false|false| true|\n|                CMOA|          Museum|    CSV|https://github.co...|                null|            10| true|false|false|false|\n|         Penn Museum|          Museum|   JSON|https://www.penn....|JSON is poorly st...|             7|false|false|false| true|\n|         Penn Museum|          Museum|    CSV|https://www.penn....|JSON is poorly st...|             7| true|false|false|false|\n|         Penn Museum|          Museum|    XML|https://www.penn....|JSON is poorly st...|             7|false| true|false|false|\n|          Met Museum|          Museum|    CSV|                null|            ¯_(ツ)_/¯|             3| true|false|false|false|\n|DigitalNZ Te Puna...|         Library|    XML|https://natlib.go...|            MARC XML|             3|false| true|false|false|\n|Canadian Subject ...|         Library|RDF/XML|http://www.collec...|            Ugh, rdf|             4|false| true| true|false|\n|                DPLA|     Aggregator |    CSV|               dp.la|                null|           100| true|false|false|false|\n|                DPLA|     Aggregator |   JSON|               dp.la|                null|           100|false|false|false| true|\n|                DPLA|     Aggregator |    XML|               dp.la|                null|           100|false| true|false|false|\n+--------------------+----------------+-------+--------------------+--------------------+--------------+-----+-----+-----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598948_-2133348711","id":"20180210-213416_1825779467","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17491"},{"title":"Check our Distinct Format Values Now","text":"sampleDf.select(\"Format\").distinct().show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n| Format|\n+-------+\n|    CSV|\n|    XML|\n|    CSV|\n|    XML|\n|RDF/XML|\n|   JSON|\n+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598949_-2133733460","id":"20180211-060909_1786306955","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17492"},{"title":"Remove Whitespace around Format using Regex ( reqexp_replace(colName, regex to replace, new value) )","text":"from pyspark.sql.functions import regexp_replace\n\nsampleDf = sampleDf.withColumn(\"Format\", regexp_replace(sampleDf.Format, \"\\s+\", \"\"))\nsampleDf.select(\"Format\").distinct().show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n| Format|\n+-------+\n|    CSV|\n|    XML|\n|RDF/XML|\n|   JSON|\n+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598949_-2133733460","id":"20180211-035409_418875897","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17493"},{"title":"Create Dataframe where Format is CSV ( .where(conditional) )","text":"CSVsampleDf = sampleDf.where((sampleDf.Format == \"CSV\"))\nCSVsampleDf.show()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":181,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------------+------+--------------------+--------------------+--------------+----+-----+-----+-----+\n|       Name|Institution Type|Format|                 URL|         Description|Informal Score| CSV|  XML|  RDF| JSON|\n+-----------+----------------+------+--------------------+--------------------+--------------+----+-----+-----+-----+\n|       CMOA|          Museum|   CSV|https://github.co...|                null|            10|true|false|false|false|\n|Penn Museum|          Museum|   CSV|https://www.penn....|JSON is poorly st...|             7|true|false|false|false|\n| Met Museum|          Museum|   CSV|                null|            ¯_(ツ)_/¯|             3|true|false|false|false|\n|       DPLA|     Aggregator |   CSV|               dp.la|                null|           100|true|false|false|false|\n+-----------+----------------+------+--------------------+--------------------+--------------+----+-----+-----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1518383598949_-2133733460","id":"20180210-215449_392462777","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17494"},{"title":"","text":"%md\n### Stopping Point: Create some Derivative Dataframes to Address Multivalue Format or related Issues","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: Create some Derivative Dataframes to Address Multivalue Format or related Issues</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598950_-2132579214","id":"20180211-205149_2050933534","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17495"},{"title":"Your Working Space: Deriving Data II","text":"\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598950_-2132579214","id":"20180211-205238_1685626655","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17496"},{"title":"","text":"%md\n# Part 4: Using SQL to Analyze our Dataset","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 4: Using SQL to Analyze our Dataset</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598950_-2132579214","id":"20180211-070011_2131671710","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17497"},{"title":"Introduction to SQL Queries ","text":"%md\nTo have a more dynamic experience, let’s create a temporary (in-memory) view that we can query against and interact with the resulting data in a table or graph format. The temporary view will allow us to execute SQL queries against it.\n\nNote that the temporary view will reside in memory as long as the Spark session is alive. [Here](http://cse.unl.edu/~sscott/ShowFiles/SQL/CheatSheet/SQLCheatSheet.html) is a SQL Cheatsheet in case you need it.","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>To have a more dynamic experience, let’s create a temporary (in-memory) view that we can query against and interact with the resulting data in a table or graph format. The temporary view will allow us to execute SQL queries against it.</p>\n<p>Note that the temporary view will reside in memory as long as the Spark session is alive. <a href=\"http://cse.unl.edu/~sscott/ShowFiles/SQL/CheatSheet/SQLCheatSheet.html\">Here</a> is a SQL Cheatsheet in case you need it.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598950_-2132579214","id":"20180211-040724_834116241","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17498"},{"title":"Creating a Temporary SQL View from our Sample Dataframe & Running a Simple SQL Query","text":"# Convert SampleDF DataFrame to a temporary view\nsampleDf.createOrReplaceTempView(\"sampleDataView\")\n\nsparkQuery = spark.sql(\"SELECT * FROM sampleDataView LIMIT 20\")\nsparkQuery.collect()","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(Name=u'CMOA', Institution Type=u'Museum', Format=u'JSON, CSV', URL=u'https://github.com/cmoa/collection', Description=None, Informal Score=Decimal('10')), Row(Name=u'Penn Museum', Institution Type=u'Museum', Format=u'JSON, CSV, XML', URL=u'https://www.penn.museum/collections/data.php', Description=u'JSON is poorly structured', Informal Score=Decimal('7')), Row(Name=u'Met Museum', Institution Type=u'Museum', Format=u'CSV', URL=None, Description=u'\\xaf_(\\u30c4)_/\\xaf', Informal Score=Decimal('3')), Row(Name=u'DigitalNZ Te Puna Web Directory', Institution Type=u'Library', Format=u'XML', URL=u'https://natlib.govt.nz/files/data/tepunawebdirectory.xml', Description=u'MARC XML', Informal Score=Decimal('3')), Row(Name=u'Canadian Subject Headings', Institution Type=u'Library', Format=u'RDF/XML', URL=u'http://www.collectionscanada.gc.ca/obj/900/f11/040004/csh.rdf', Description=u'Ugh, rdf', Informal Score=Decimal('4')), Row(Name=u'DPLA', Institution Type=u'Aggregator ', Format=u'CSV,JSON,XML', URL=u'dp.la', Description=None, Informal Score=Decimal('100'))]\n"}]},"apps":[],"jobName":"paragraph_1518383598950_-2132579214","id":"20180211-071952_1262010614","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17499"},{"title":"Querying our Temporary View for Number of Distinct Formats per Institution Type","text":"sparkQuery = spark.sql(\"\"\"SELECT `Institution Type`, COUNT(DISTINCT(Format)) AS NumFormats FROM sampleDataView GROUP BY `Institution Type`\"\"\")\nsparkQuery.collect()\nfor n in sparkQuery.collect():\n    n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(Institution Type=u'Library', NumFormats=2)\nRow(Institution Type=u'Aggregator ', NumFormats=1)\nRow(Institution Type=u'Museum', NumFormats=3)\n"}]},"apps":[],"jobName":"paragraph_1518383598951_-2132963962","id":"20180211-072058_265727285","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17500"},{"title":"","text":"%md\n### Stopping Point: Create a Temporary View & Run a SQL Query","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: Create a Temporary View &amp; Run a SQL Query</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598951_-2132963962","id":"20180211-205631_117220376","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17501"},{"title":"Your Working Space: Create a Spark View from your Dataframe(s)","text":"\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598951_-2132963962","id":"20180211-205653_111316135","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17502"},{"title":"Your Working Space: Run some Spark SQL Queries","text":"\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598951_-2132963962","id":"20180211-211110_718731458","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17503"},{"title":"","text":"%md\n# Part 5: Simple Data Visualization","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 5: Simple Data Visualization</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598952_-2134887707","id":"20180211-072644_1534169002","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17504"},{"text":"%sql \nSELECT `Institution Type`, COUNT(DISTINCT(Format)) AS NumFormats\nFROM sampleDataView\nGROUP BY `Institution Type`","dateUpdated":"2018-02-11T21:13:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Institution Type\tNumFormats\nLibrary\t2\nAggregator \t1\nMuseum\t3\n"}]},"apps":[],"jobName":"paragraph_1518383598952_-2134887707","id":"20180211-210732_864456388","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17505"},{"title":"","text":"%md\n### Stopping Point: From your Temporary Views, Create a Simple Viz","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Stopping Point: From your Temporary Views, Create a Simple Viz</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1518383598952_-2134887707","id":"20180211-211201_433698257","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17506"},{"title":"Your Working Space: Spark View => SQL Query & Viz","text":"%sql\n\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"lineNumbers":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598952_-2134887707","id":"20180211-211029_1012657635","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17507"},{"text":"%md\n","dateUpdated":"2018-02-11T21:13:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1518383598952_-2134887707","id":"20180211-080404_990095708","dateCreated":"2018-02-11T21:13:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17508"}],"name":"Spark Workshop: CHO Data","id":"2D7X76UPB","angularObjects":{"2D8F6TC39:shared_process":[],"2D7NXVY4B:shared_process":[],"2D8A6MQRC:shared_process":[],"2D5PJ3NSA:shared_process":[],"2D6EP7ZA2:shared_process":[],"2D5TJGRY4:shared_process":[],"2D5VZHKP9:shared_process":[],"2D89YMPRJ:shared_process":[],"2D72HVDPJ:shared_process":[],"2D6DB2GSE:shared_process":[],"2D7ZKW5Z8:shared_process":[],"2D6YB5W7T:shared_process":[],"2D6DKU8MK:shared_process":[],"2D4ZW7PCP:shared_process":[],"2D566ZBPK:shared_process":[],"2D866A3V3:shared_process":[],"2D7TTRTEG:shared_process":[],"2D71TQHNV:shared_process":[],"2D57SSSRY:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}